require 'test_helper'

class ExecutablesControllerTest < ActionController::TestCase
  setup do
    @executable = executables(:one)
  end

  test "should get index" do
    get :index
    assert_response :success
    assert_not_nil assigns(:executables)
  end

  test "should get new" do
    get :new
    assert_response :success
  end

  test "should create executable" do
    assert_difference('Executable.count') do
      post :create, executable: { anti_debug: @executable.anti_debug, anti_vm: @executable.anti_vm, av_detection: @executable.av_detection, communication_samples: @executable.communication_samples, created_or_destroyed_processes: @executable.created_or_destroyed_processes, dns_names: @executable.dns_names, dropped_files_sha256: @executable.dropped_files_sha256, file_size_string: @executable.file_size_string, file_system_modifications: @executable.file_system_modifications, generated_mutexes: @executable.generated_mutexes, ids_signatures: @executable.ids_signatures, image_debug_directory_address_of_raw_data: @executable.image_debug_directory_address_of_raw_data, image_debug_directory_characteristics: @executable.image_debug_directory_characteristics, image_debug_directory_major_version: @executable.image_debug_directory_major_version, image_debug_directory_minor_version: @executable.image_debug_directory_minor_version, image_debug_directory_pointer_to_raw_data: @executable.image_debug_directory_pointer_to_raw_data, image_debug_directory_size_of_data: @executable.image_debug_directory_size_of_data, image_debug_directory_time_date_stamp: @executable.image_debug_directory_time_date_stamp, image_debug_directory_type: @executable.image_debug_directory_type, image_debug_type_codeview: @executable.image_debug_type_codeview, image_file_header_characteristics: @executable.image_file_header_characteristics, image_file_header_machine: @executable.image_file_header_machine, image_file_header_number_of_sections: @executable.image_file_header_number_of_sections, image_file_header_number_of_symbols: @executable.image_file_header_number_of_symbols, image_file_header_pointer_to_symbol_table: @executable.image_file_header_pointer_to_symbol_table, image_file_header_size_of_optional_header: @executable.image_file_header_size_of_optional_header, image_file_header_time_date_stamp: @executable.image_file_header_time_date_stamp, image_load_config_directory_critical_section_default_timeout: @executable.image_load_config_directory_critical_section_default_timeout, image_load_config_directory_csd_version: @executable.image_load_config_directory_csd_version, image_load_config_directory_decommit_free_block_threshold: @executable.image_load_config_directory_decommit_free_block_threshold, image_load_config_directory_decommit_total_free_threshold: @executable.image_load_config_directory_decommit_total_free_threshold, image_load_config_directory_edit_list_va: @executable.image_load_config_directory_edit_list_va, image_load_config_directory_global_flags_clear: @executable.image_load_config_directory_global_flags_clear, image_load_config_directory_global_flags_set: @executable.image_load_config_directory_global_flags_set, image_load_config_directory_major_version: @executable.image_load_config_directory_major_version, image_load_config_directory_maximum_allocation_size: @executable.image_load_config_directory_maximum_allocation_size, image_load_config_directory_minor_version: @executable.image_load_config_directory_minor_version, image_load_config_directory_process_affinity_mask: @executable.image_load_config_directory_process_affinity_mask, image_load_config_directory_process_heap_flags: @executable.image_load_config_directory_process_heap_flags, image_load_config_directory_reserved: @executable.image_load_config_directory_reserved, image_load_config_directory_se_handler_count: @executable.image_load_config_directory_se_handler_count, image_load_config_directory_se_handler_table_va: @executable.image_load_config_directory_se_handler_table_va, image_load_config_directory_security_cookie_va: @executable.image_load_config_directory_security_cookie_va, image_load_config_directory_size: @executable.image_load_config_directory_size, image_load_config_directory_time_date_stamp: @executable.image_load_config_directory_time_date_stamp, image_load_config_directory_virtual_memory_threshold: @executable.image_load_config_directory_virtual_memory_threshold, image_optional_header_address_of_entry_point: @executable.image_optional_header_address_of_entry_point, image_optional_header_architecture_specific_data_rva: @executable.image_optional_header_architecture_specific_data_rva, image_optional_header_architecture_specific_data_size: @executable.image_optional_header_architecture_specific_data_size, image_optional_header_base_of_code: @executable.image_optional_header_base_of_code, image_optional_header_base_of_data: @executable.image_optional_header_base_of_data, image_optional_header_base_relocation_table_rva: @executable.image_optional_header_base_relocation_table_rva, image_optional_header_base_relocation_table_size: @executable.image_optional_header_base_relocation_table_size, image_optional_header_bound_import_table_rva: @executable.image_optional_header_bound_import_table_rva, image_optional_header_bound_import_table_size: @executable.image_optional_header_bound_import_table_size, image_optional_header_certificate_table_offset: @executable.image_optional_header_certificate_table_offset, image_optional_header_certificate_table_size: @executable.image_optional_header_certificate_table_size, image_optional_header_checksum: @executable.image_optional_header_checksum, image_optional_header_cli_header_rva: @executable.image_optional_header_cli_header_rva, image_optional_header_cli_header_size: @executable.image_optional_header_cli_header_size, image_optional_header_debug_directory_rva: @executable.image_optional_header_debug_directory_rva, image_optional_header_debug_directory_size: @executable.image_optional_header_debug_directory_size, image_optional_header_delay_import_descriptors_rva: @executable.image_optional_header_delay_import_descriptors_rva, image_optional_header_delay_import_descriptors_size: @executable.image_optional_header_delay_import_descriptors_size, image_optional_header_dll_characteristics: @executable.image_optional_header_dll_characteristics, image_optional_header_end_rva: @executable.image_optional_header_end_rva, image_optional_header_end_size: @executable.image_optional_header_end_size, image_optional_header_exception_table_rva: @executable.image_optional_header_exception_table_rva, image_optional_header_exception_table_size: @executable.image_optional_header_exception_table_size, image_optional_header_export_table_rva: @executable.image_optional_header_export_table_rva, image_optional_header_export_table_size: @executable.image_optional_header_export_table_size, image_optional_header_file_alignment: @executable.image_optional_header_file_alignment, image_optional_header_global_pointer_register_rva: @executable.image_optional_header_global_pointer_register_rva, image_optional_header_global_pointer_register_size: @executable.image_optional_header_global_pointer_register_size, image_optional_header_image_base: @executable.image_optional_header_image_base, image_optional_header_import_address_table_rva: @executable.image_optional_header_import_address_table_rva, image_optional_header_import_address_table_size: @executable.image_optional_header_import_address_table_size, image_optional_header_import_table_rva: @executable.image_optional_header_import_table_rva, image_optional_header_import_table_size: @executable.image_optional_header_import_table_size, image_optional_header_load_configuration_table_rva: @executable.image_optional_header_load_configuration_table_rva, image_optional_header_load_configuration_table_size: @executable.image_optional_header_load_configuration_table_size, image_optional_header_loader_flags: @executable.image_optional_header_loader_flags, image_optional_header_magic: @executable.image_optional_header_magic, image_optional_header_major_image_version: @executable.image_optional_header_major_image_version, image_optional_header_major_linker_version: @executable.image_optional_header_major_linker_version, image_optional_header_major_os_version: @executable.image_optional_header_major_os_version, image_optional_header_major_subsystem_version: @executable.image_optional_header_major_subsystem_version, image_optional_header_minor_image_version: @executable.image_optional_header_minor_image_version, image_optional_header_minor_linker_version: @executable.image_optional_header_minor_linker_version, image_optional_header_minor_os_version: @executable.image_optional_header_minor_os_version, image_optional_header_minor_subsystem_version: @executable.image_optional_header_minor_subsystem_version, image_optional_header_number_of_data_directories: @executable.image_optional_header_number_of_data_directories, image_optional_header_resource_table_rva: @executable.image_optional_header_resource_table_rva, image_optional_header_resource_table_size: @executable.image_optional_header_resource_table_size, image_optional_header_section_alignment: @executable.image_optional_header_section_alignment, image_optional_header_size_of_code: @executable.image_optional_header_size_of_code, image_optional_header_size_of_headers: @executable.image_optional_header_size_of_headers, image_optional_header_size_of_heap_commit: @executable.image_optional_header_size_of_heap_commit, image_optional_header_size_of_heap_reserve: @executable.image_optional_header_size_of_heap_reserve, image_optional_header_size_of_image: @executable.image_optional_header_size_of_image, image_optional_header_size_of_initialized_data: @executable.image_optional_header_size_of_initialized_data, image_optional_header_size_of_stack_commit: @executable.image_optional_header_size_of_stack_commit, image_optional_header_size_of_stack_reserve: @executable.image_optional_header_size_of_stack_reserve, image_optional_header_size_of_uninitialized_data: @executable.image_optional_header_size_of_uninitialized_data, image_optional_header_subsystem: @executable.image_optional_header_subsystem, image_optional_header_tls_table_rva: @executable.image_optional_header_tls_table_rva, image_optional_header_tls_table_size: @executable.image_optional_header_tls_table_size, image_optional_header_win32_version_value: @executable.image_optional_header_win32_version_value, image_section_headers: @executable.image_section_headers, import_address_table: @executable.import_address_table, import_directory_table: @executable.import_directory_table, import_hints_names_and_dll_names: @executable.import_hints_names_and_dll_names, inport_name_table: @executable.inport_name_table, ip_addresses: @executable.ip_addresses, md5: @executable.md5, notes: @executable.notes, other: @executable.other, parent_file_sha256: @executable.parent_file_sha256, pcap_artifact: @executable.pcap_artifact, registry_modifications: @executable.registry_modifications, section_sums: @executable.section_sums, sha1: @executable.sha1, sha256: @executable.sha256, unpacked_file_sha256: @executable.unpacked_file_sha256 }
    end

    assert_redirected_to executable_path(assigns(:executable))
  end

  test "should show executable" do
    get :show, id: @executable
    assert_response :success
  end

  test "should get edit" do
    get :edit, id: @executable
    assert_response :success
  end

  test "should update executable" do
    patch :update, id: @executable, executable: { anti_debug: @executable.anti_debug, anti_vm: @executable.anti_vm, av_detection: @executable.av_detection, communication_samples: @executable.communication_samples, created_or_destroyed_processes: @executable.created_or_destroyed_processes, dns_names: @executable.dns_names, dropped_files_sha256: @executable.dropped_files_sha256, file_size_string: @executable.file_size_string, file_system_modifications: @executable.file_system_modifications, generated_mutexes: @executable.generated_mutexes, ids_signatures: @executable.ids_signatures, image_debug_directory_address_of_raw_data: @executable.image_debug_directory_address_of_raw_data, image_debug_directory_characteristics: @executable.image_debug_directory_characteristics, image_debug_directory_major_version: @executable.image_debug_directory_major_version, image_debug_directory_minor_version: @executable.image_debug_directory_minor_version, image_debug_directory_pointer_to_raw_data: @executable.image_debug_directory_pointer_to_raw_data, image_debug_directory_size_of_data: @executable.image_debug_directory_size_of_data, image_debug_directory_time_date_stamp: @executable.image_debug_directory_time_date_stamp, image_debug_directory_type: @executable.image_debug_directory_type, image_debug_type_codeview: @executable.image_debug_type_codeview, image_file_header_characteristics: @executable.image_file_header_characteristics, image_file_header_machine: @executable.image_file_header_machine, image_file_header_number_of_sections: @executable.image_file_header_number_of_sections, image_file_header_number_of_symbols: @executable.image_file_header_number_of_symbols, image_file_header_pointer_to_symbol_table: @executable.image_file_header_pointer_to_symbol_table, image_file_header_size_of_optional_header: @executable.image_file_header_size_of_optional_header, image_file_header_time_date_stamp: @executable.image_file_header_time_date_stamp, image_load_config_directory_critical_section_default_timeout: @executable.image_load_config_directory_critical_section_default_timeout, image_load_config_directory_csd_version: @executable.image_load_config_directory_csd_version, image_load_config_directory_decommit_free_block_threshold: @executable.image_load_config_directory_decommit_free_block_threshold, image_load_config_directory_decommit_total_free_threshold: @executable.image_load_config_directory_decommit_total_free_threshold, image_load_config_directory_edit_list_va: @executable.image_load_config_directory_edit_list_va, image_load_config_directory_global_flags_clear: @executable.image_load_config_directory_global_flags_clear, image_load_config_directory_global_flags_set: @executable.image_load_config_directory_global_flags_set, image_load_config_directory_major_version: @executable.image_load_config_directory_major_version, image_load_config_directory_maximum_allocation_size: @executable.image_load_config_directory_maximum_allocation_size, image_load_config_directory_minor_version: @executable.image_load_config_directory_minor_version, image_load_config_directory_process_affinity_mask: @executable.image_load_config_directory_process_affinity_mask, image_load_config_directory_process_heap_flags: @executable.image_load_config_directory_process_heap_flags, image_load_config_directory_reserved: @executable.image_load_config_directory_reserved, image_load_config_directory_se_handler_count: @executable.image_load_config_directory_se_handler_count, image_load_config_directory_se_handler_table_va: @executable.image_load_config_directory_se_handler_table_va, image_load_config_directory_security_cookie_va: @executable.image_load_config_directory_security_cookie_va, image_load_config_directory_size: @executable.image_load_config_directory_size, image_load_config_directory_time_date_stamp: @executable.image_load_config_directory_time_date_stamp, image_load_config_directory_virtual_memory_threshold: @executable.image_load_config_directory_virtual_memory_threshold, image_optional_header_address_of_entry_point: @executable.image_optional_header_address_of_entry_point, image_optional_header_architecture_specific_data_rva: @executable.image_optional_header_architecture_specific_data_rva, image_optional_header_architecture_specific_data_size: @executable.image_optional_header_architecture_specific_data_size, image_optional_header_base_of_code: @executable.image_optional_header_base_of_code, image_optional_header_base_of_data: @executable.image_optional_header_base_of_data, image_optional_header_base_relocation_table_rva: @executable.image_optional_header_base_relocation_table_rva, image_optional_header_base_relocation_table_size: @executable.image_optional_header_base_relocation_table_size, image_optional_header_bound_import_table_rva: @executable.image_optional_header_bound_import_table_rva, image_optional_header_bound_import_table_size: @executable.image_optional_header_bound_import_table_size, image_optional_header_certificate_table_offset: @executable.image_optional_header_certificate_table_offset, image_optional_header_certificate_table_size: @executable.image_optional_header_certificate_table_size, image_optional_header_checksum: @executable.image_optional_header_checksum, image_optional_header_cli_header_rva: @executable.image_optional_header_cli_header_rva, image_optional_header_cli_header_size: @executable.image_optional_header_cli_header_size, image_optional_header_debug_directory_rva: @executable.image_optional_header_debug_directory_rva, image_optional_header_debug_directory_size: @executable.image_optional_header_debug_directory_size, image_optional_header_delay_import_descriptors_rva: @executable.image_optional_header_delay_import_descriptors_rva, image_optional_header_delay_import_descriptors_size: @executable.image_optional_header_delay_import_descriptors_size, image_optional_header_dll_characteristics: @executable.image_optional_header_dll_characteristics, image_optional_header_end_rva: @executable.image_optional_header_end_rva, image_optional_header_end_size: @executable.image_optional_header_end_size, image_optional_header_exception_table_rva: @executable.image_optional_header_exception_table_rva, image_optional_header_exception_table_size: @executable.image_optional_header_exception_table_size, image_optional_header_export_table_rva: @executable.image_optional_header_export_table_rva, image_optional_header_export_table_size: @executable.image_optional_header_export_table_size, image_optional_header_file_alignment: @executable.image_optional_header_file_alignment, image_optional_header_global_pointer_register_rva: @executable.image_optional_header_global_pointer_register_rva, image_optional_header_global_pointer_register_size: @executable.image_optional_header_global_pointer_register_size, image_optional_header_image_base: @executable.image_optional_header_image_base, image_optional_header_import_address_table_rva: @executable.image_optional_header_import_address_table_rva, image_optional_header_import_address_table_size: @executable.image_optional_header_import_address_table_size, image_optional_header_import_table_rva: @executable.image_optional_header_import_table_rva, image_optional_header_import_table_size: @executable.image_optional_header_import_table_size, image_optional_header_load_configuration_table_rva: @executable.image_optional_header_load_configuration_table_rva, image_optional_header_load_configuration_table_size: @executable.image_optional_header_load_configuration_table_size, image_optional_header_loader_flags: @executable.image_optional_header_loader_flags, image_optional_header_magic: @executable.image_optional_header_magic, image_optional_header_major_image_version: @executable.image_optional_header_major_image_version, image_optional_header_major_linker_version: @executable.image_optional_header_major_linker_version, image_optional_header_major_os_version: @executable.image_optional_header_major_os_version, image_optional_header_major_subsystem_version: @executable.image_optional_header_major_subsystem_version, image_optional_header_minor_image_version: @executable.image_optional_header_minor_image_version, image_optional_header_minor_linker_version: @executable.image_optional_header_minor_linker_version, image_optional_header_minor_os_version: @executable.image_optional_header_minor_os_version, image_optional_header_minor_subsystem_version: @executable.image_optional_header_minor_subsystem_version, image_optional_header_number_of_data_directories: @executable.image_optional_header_number_of_data_directories, image_optional_header_resource_table_rva: @executable.image_optional_header_resource_table_rva, image_optional_header_resource_table_size: @executable.image_optional_header_resource_table_size, image_optional_header_section_alignment: @executable.image_optional_header_section_alignment, image_optional_header_size_of_code: @executable.image_optional_header_size_of_code, image_optional_header_size_of_headers: @executable.image_optional_header_size_of_headers, image_optional_header_size_of_heap_commit: @executable.image_optional_header_size_of_heap_commit, image_optional_header_size_of_heap_reserve: @executable.image_optional_header_size_of_heap_reserve, image_optional_header_size_of_image: @executable.image_optional_header_size_of_image, image_optional_header_size_of_initialized_data: @executable.image_optional_header_size_of_initialized_data, image_optional_header_size_of_stack_commit: @executable.image_optional_header_size_of_stack_commit, image_optional_header_size_of_stack_reserve: @executable.image_optional_header_size_of_stack_reserve, image_optional_header_size_of_uninitialized_data: @executable.image_optional_header_size_of_uninitialized_data, image_optional_header_subsystem: @executable.image_optional_header_subsystem, image_optional_header_tls_table_rva: @executable.image_optional_header_tls_table_rva, image_optional_header_tls_table_size: @executable.image_optional_header_tls_table_size, image_optional_header_win32_version_value: @executable.image_optional_header_win32_version_value, image_section_headers: @executable.image_section_headers, import_address_table: @executable.import_address_table, import_directory_table: @executable.import_directory_table, import_hints_names_and_dll_names: @executable.import_hints_names_and_dll_names, inport_name_table: @executable.inport_name_table, ip_addresses: @executable.ip_addresses, md5: @executable.md5, notes: @executable.notes, other: @executable.other, parent_file_sha256: @executable.parent_file_sha256, pcap_artifact: @executable.pcap_artifact, registry_modifications: @executable.registry_modifications, section_sums: @executable.section_sums, sha1: @executable.sha1, sha256: @executable.sha256, unpacked_file_sha256: @executable.unpacked_file_sha256 }
    assert_redirected_to executable_path(assigns(:executable))
  end

  test "should destroy executable" do
    assert_difference('Executable.count', -1) do
      delete :destroy, id: @executable
    end

    assert_redirected_to executables_path
  end
end
